# Protocolista Telegram Bot

Telegram –±–æ—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Whisper, NeMo –∏ Ollama.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üé§ –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è —Ä–µ—á–∏ –∏–∑ –∞—É–¥–∏–æ (Whisper)
- üë• –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—á–∏ –ø–æ —Å–ø–∏–∫–µ—Ä–∞–º (NeMo)
- üìù –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∞–º–º–∞—Ä–∏ (Ollama + Gemma)
- üí¨ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python >= 3.9
- pip

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/vladker/protocolista.git
cd protocolista
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
python -m venv venv
source venv/bin/activate  # –ù–∞ Windows: venv\Scripts\activate
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
pip install -r requirements-dev.txt
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```env
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
WHISPER_MODEL=base
DIARIZATION_MAX_SPEAKERS=12
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤

```bash
pip install -r requirements-dev.txt
```

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤

```bash
pytest
```

### –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º

```bash
pytest --cov=telegram_bot --cov-report=html
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

```bash
# –¢–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã
pytest tests/ -m unit

# –¢–æ–ª—å–∫–æ integration —Ç–µ—Å—Ç—ã
pytest tests/ -m integration

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
pytest tests/test_transcription.py::TestTranscription::test_format_transcript_basic
```

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Make

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
make test

# –¢–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
make test-cov

# –¢–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã
make test-unit
```

## üîç –õ–∏–Ω—Ç–∏–Ω–≥

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –ª–∏–Ω—Ç–µ—Ä–æ–≤

```bash
flake8 telegram_bot.py
mypy telegram_bot.py
bandit -r telegram_bot.py
```

### –ê–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```bash
# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
make format

# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤
isort telegram_bot.py

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Black
black telegram_bot.py
```

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Make

```bash
# –í—Å–µ –ª–∏–Ω—Ç–µ—Ä—ã
make lint

# –ê–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
make lint-fix
```

## ‚ö° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã —Å –±–æ—Ç–æ–º
- `/help` - –°–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- `/s2t` - –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –±–µ–∑ —Å–ø–∏–∫–µ—Ä–æ–≤
- `/s2t_spk` - –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Å–æ —Å–ø–∏–∫–µ—Ä–∞–º–∏
- `/md` - –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –≤ Markdown
- `/list` - –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Å–æ —Å–ø–∏—Å–∫–∞–º–∏
- `/summary` - –°–≤–æ–¥–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –≤ —á–∞—Ç
- `/summary_md` - –°–≤–æ–¥–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –≤ —Ñ–∞–π–ª
- `/protocol` - –ü—Ä–æ—Ç–æ–∫–æ–ª –≤—Å—Ç—Ä–µ—á–∏ –≤ —á–∞—Ç
- `/protocol_md` - –ü—Ä–æ—Ç–æ–∫–æ–ª –≤—Å—Ç—Ä–µ—á–∏ –≤ —Ñ–∞–π–ª

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É –∞—É–¥–∏–æ—Ñ–∞–π–ª (mp3, wav, m4a, ogg)
2. –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ–∞–π–ª
3. –ü–æ–ª—É—á–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã: —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é, –¥–∏–∞—Ä–∏–∑–∞—Ü–∏—é –∏ —Å–∞–º–º–∞—Ä–∏

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
protocolista/
‚îú‚îÄ‚îÄ telegram_bot.py          # –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å –±–æ—Ç–∞
‚îú‚îÄ‚îÄ tests/                   # –¢–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ test_transcription.py
‚îÇ   ‚îú‚îÄ‚îÄ test_commands.py
‚îÇ   ‚îî‚îÄ‚îÄ test_utils.py
‚îú‚îÄ‚îÄ requirements.txt         # –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ requirements-dev.txt     # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ pytest.ini              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest
‚îú‚îÄ‚îÄ .flake8                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è flake8
‚îú‚îÄ‚îÄ .mypy.ini               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è mypy
‚îú‚îÄ‚îÄ pyproject.toml          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ .pre-commit-config.yaml # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pre-commit
‚îú‚îÄ‚îÄ .black                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Black
‚îú‚îÄ‚îÄ .yamllint               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è YAML
‚îú‚îÄ‚îÄ Makefile                # –ö–æ–º–∞–Ω–¥—ã –¥–ª—è Make
‚îî‚îÄ‚îÄ README.md
```

## ü§ñ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### Ollama

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Ollama –∑–∞–ø—É—â–µ–Ω:

```bash
ollama serve
```

–ó–∞–≥—Ä—É–∑–∏—Ç–µ –º–æ–¥–µ–ª—å:

```bash
ollama pull gemma3:27b
```

### Whisper

–ú–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ.

### NeMo

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ NeMo –¥–ª—è –¥–∏–∞—Ä–∏–∑–∞—Ü–∏–∏:

```bash
pip install nemo-toolkit[collections]
```

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ pre-commit hooks
pre-commit install

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º
pre-commit run --all-files
```

### CI/CD

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ CI:

```bash
make ci
```

## üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏–Ω—Ç–µ—Ä–æ–≤

### flake8

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `.flake8`

### mypy

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `.mypy.ini`

### bandit

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `pyproject.toml`

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º –≤ –∫–æ–¥–µ –∏ —Ñ–∞–π–ª–∞–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

## ü§ù –£—á–∞—Å—Ç–∏–µ

Pull requests –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è!

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üêõ –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å –ø—Ä–æ–±–ª–µ–º–æ–π, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–∫—Ä–æ–π—Ç–µ issue –Ω–∞ GitHub.